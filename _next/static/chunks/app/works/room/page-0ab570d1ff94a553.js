(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[541],{6866:function(e,t,r){Promise.resolve().then(r.bind(r,2535))},2535:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var o=r(3827),i=r(6376),s=r(4797);let n=new WeakMap;class a extends i.aNw{setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,o){let s=new i.hH6(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,e=>{let r={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,r).then(t).catch(o)},r,o)}decodeDracoFile(e,t,r,o){let i={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:o||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,i).then(t)}decodeGeometry(e,t){let r;for(let e in t.attributeTypes){let r=t.attributeTypes[e];void 0!==r.BYTES_PER_ELEMENT&&(t.attributeTypes[e]=r.name)}let o=JSON.stringify(t);if(n.has(e)){let t=n.get(e);if(t.key===o)return t.promise;if(0===e.byteLength)throw Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(i,s).then(o=>(r=o,new Promise((o,s)=>{r._callbacks[i]={resolve:o,reject:s},r.postMessage({type:"decode",id:i,taskConfig:t,buffer:e},[e])}))).then(e=>this._createGeometry(e.geometry));return a.catch(()=>!0).then(()=>{r&&i&&this._releaseTask(r,i)}),n.set(e,{key:o,promise:a}),a}_createGeometry(e){let t=new i.u9r;e.index&&t.setIndex(new i.TlE(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let o=e.attributes[r],s=o.name,n=o.array,a=o.itemSize;t.setAttribute(s,new i.TlE(n,a))}return t}_loadLibrary(e,t){let r=new i.hH6(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((t,o)=>{r.load(e,t,void 0,o)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(t=>{let r=t[0];e||(this.decoderConfig.wasmBinary=t[1]);let o=d.toString(),i=["/* draco decoder */",r,"","/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([i]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){let r=t.data;switch(r.type){case"decode":e._callbacks[r.id].resolve(r);break;case"error":e._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort(function(e,t){return e._taskLoad>t._taskLoad?-1:1});let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}}function d(){let e,t;onmessage=function(r){let o=r.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise(function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)});break;case"decode":let i=o.buffer,s=o.taskConfig;t.then(e=>{let t=e.draco,r=new t.Decoder,n=new t.DecoderBuffer;n.Init(new Int8Array(i),i.byteLength);try{let e=function(e,t,r,o){let i,s;let n=o.attributeIDs,a=o.attributeTypes,d=t.GetEncodedGeometryType(r);if(d===e.TRIANGULAR_MESH)i=new e.Mesh,s=t.DecodeBufferToMesh(r,i);else if(d===e.POINT_CLOUD)i=new e.PointCloud,s=t.DecodeBufferToPointCloud(r,i);else throw Error("THREE.DRACOLoader: Unexpected geometry type.");if(!s.ok()||0===i.ptr)throw Error("THREE.DRACOLoader: Decoding failed: "+s.error_msg());let l={index:null,attributes:[]};for(let r in n){let s,d;let c=self[a[r]];if(o.useUniqueIDs)d=n[r],s=t.GetAttributeByUniqueId(i,d);else{if(-1===(d=t.GetAttributeId(i,e[n[r]])))continue;s=t.GetAttribute(i,d)}l.attributes.push(function(e,t,r,o,i,s){let n=s.num_components(),a=r.num_points()*n,d=a*i.BYTES_PER_ELEMENT,l=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,i),c=e._malloc(d);t.GetAttributeDataArrayForAllPoints(r,s,l,d,c);let u=new i(e.HEAPF32.buffer,c,a).slice();return e._free(c),{name:o,array:u,itemSize:n}}(e,t,i,r,c,s))}return d===e.TRIANGULAR_MESH&&(l.index=function(e,t,r){let o=3*r.num_faces(),i=4*o,s=e._malloc(i);t.GetTrianglesUInt32Array(r,i,s);let n=new Uint32Array(e.HEAPF32.buffer,s,o).slice();return e._free(s),{array:n,itemSize:1}}(e,t,i)),e.destroy(i),l}(t,r,n,s),i=e.attributes.map(e=>e.array.buffer);e.index&&i.push(e.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:e},i)}catch(e){console.error(e),self.postMessage({type:"error",id:o.id,error:e.message})}finally{t.destroy(n),t.destroy(r)}})}}}var l=r(3696),c={ROOM_WIDTH:800};{let e;let t=document.getElementById("room-wrapper"),r=document.getElementById("room"),o={width:0,height:0};o.width=Math.min(document.body.clientWidth,c.ROOM_WIDTH),o.height=Math.min(window.innerHeight,o.width);let n=new i.xsS,d=document.querySelector(".overlay"),u=document.querySelector(".loading-bar"),h=new i.lLk(()=>{l.p8.delayedCall(.5,()=>{d.classList.add("ended"),u.style.transform="",u.classList.add("ended")}),l.p8.delayedCall(1,()=>{d.style.display="none"})},(e,t,r)=>{u.style.opacity="1",u.style.transform="scaleX(".concat(t/r,")")}),m=new i.dpR(h),p=new a;p.setDecoderPath("/assets/draco/");let y=new s.E(h);y.setDRACOLoader(p);let w=m.load("/assets/works/room/textures/labo_baked.jpg");w.flipY=!1,w.encoding=i.knz;let f=[];[{name:"book001",type:"texture",path:"/assets/works/room/textures/books/js_nyumon-min.jpeg"},{name:"book002",type:"texture",path:"/assets/works/room/textures/books/js_oreilly-min.jpeg"},{name:"book003",type:"texture",path:"/assets/works/room/textures/books/vue-min.jpeg"},{name:"book004",type:"texture",path:"/assets/works/room/textures/books/scss-min.jpeg"},{name:"book005",type:"texture",path:"/assets/works/room/textures/books/php_oreilly-min.jpg"},{name:"book006",type:"texture",path:"/assets/works/room/textures/books/laravel_1-min.jpeg"},{name:"book007",type:"texture",path:"/assets/works/room/textures/books/laravel_2-min.jpeg"},{name:"book008",type:"texture",path:"/assets/works/room/textures/books/sql-min.jpg"},{name:"book009",type:"texture",path:"/assets/works/room/textures/books/linux-min.jpg"}].map(e=>{let t=m.load(e.path);t.flipY=!1,t.encoding=i.knz,f.push({name:e.name,texture:t})});let k=new i.jyz({uniforms:{uTime:{value:0}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n            vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n            vec4 viewPosition = viewMatrix * modelPosition;\n            vec4 projectionPosition = projectionMatrix * viewPosition;\n\n            gl_Position = projectionPosition;\n\n            vUv = uv;\n        }\n    ",fragmentShader:"\n        varying vec2 vUv;\n        uniform float uTime;\n\n        void main() {\n\n            gl_FragColor = vec4(vUv.x * sin(uTime), vUv.y * cos(uTime), cos(uTime * 0.3), 1.0);\n        }\n    "}),b=[{name:"baked",material:new i.vBJ({map:w})},{name:"monitor_body",material:k},{name:"Text",material:new i.vBJ({color:5597568})}];f.map(e=>{let{name:t,texture:r}=e;b.push({name:t,material:new i.vBJ({map:r})})}),y.load("/assets/works/room/models/room.glb",t=>{t.scene.children.forEach(e=>{var t;let r=null===(t=b.find(t=>{let{name:r}=t;return e.name===r}))||void 0===t?void 0:t.material;r&&(e.material=r)}),(e=t.scene).rotation.y=-Math.PI/4,e.position.y=-2,n.add(e)}),window.addEventListener("resize",()=>{o.width=Math.min(document.body.clientWidth,c.ROOM_WIDTH),o.height=Math.min(window.innerHeight,o.width),g.aspect=o.width/o.height,g.updateProjectionMatrix(),T.setSize(o.width,o.height),T.setPixelRatio(Math.min(window.devicePixelRatio,2))}),null==t||t.addEventListener("mousemove",e=>{let t=-(e.clientX-.5*o.width)/(.5*o.width),r=(e.clientY-.5*o.height)/(.5*o.height);g.position.x=16*Math.sin(t*Math.PI/16),g.position.z=16*Math.cos(t*Math.PI/16),g.position.y=1+2*r,g.lookAt(0,0,0)});let g=new i.cPb(50,o.width/o.height,.1,100);g.position.set(0,1,16),g.lookAt(0,0,0),n.add(g);let _=new i.Ox3(16777215,.8);_.position.set(30,10,5),n.add(_);let x=new i.Mig(16777215,.4);n.add(x);let T=new i.CP7({canvas:r,antialias:!0,alpha:!0});T.setSize(o.width,o.height),T.setPixelRatio(Math.min(window.devicePixelRatio,2)),T.outputEncoding=i.knz,T.setClearColor(16777215,0);let v=new i.SUY,P=()=>{let e=v.getElapsedTime();k.uniforms.uTime.value=e,T.render(n,g),window.requestAnimationFrame(P)};P()}function u(){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{id:"room-wrapper",className:"flex justify-center",children:(0,o.jsx)("canvas",{id:"room",className:"room"})}),(0,o.jsxs)("div",{className:"overlay text-center fixed top-1/2 left-1/2",children:[(0,o.jsx)("div",{className:"loading-str",children:"Loading..."}),(0,o.jsx)("div",{className:"loading-bar"})]})]})}}},function(e){e.O(0,[689,922,64,971,69,744],function(){return e(e.s=6866)}),_N_E=e.O()}]);